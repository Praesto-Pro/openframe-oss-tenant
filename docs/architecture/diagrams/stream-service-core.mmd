flowchart LR
    subgraph tools["Integrated Tools"]
        Mesh["MeshCentral"]
        Tactical["Tactical RMM"]
        Fleet["Fleet MDM"]
    end

    subgraph kafka["Kafka Topics"]
        RawEvents["Inbound Tool Events"]
        Activities["Fleet Activities"]
        HostActivities["Fleet Host Activities"]
    end

    subgraph stream["Stream Service Core"]
        Listener["JsonKafkaListener"]
        Processor["Generic / Debezium Handlers"]
        Enrichment["Data Enrichment Services"]
        Streams["Kafka Streams Enrichment"]
        Mapper["EventTypeMapper"]
    end

    subgraph output["Enriched Topics"]
        UnifiedEvents["Unified Events Topic"]
    end

    Mesh --> RawEvents
    Tactical --> RawEvents
    Fleet --> Activities
    Fleet --> HostActivities

    RawEvents --> Listener
    Listener --> Processor
    Processor --> Enrichment
    Enrichment --> Mapper
    Activities --> Streams
    HostActivities --> Streams
    Streams --> UnifiedEvents
    Mapper --> UnifiedEvents
