sequenceDiagram
    participant User
    participant UI as "Chat UI"
    participant Core as "Chat Frontend Core"
    participant WS as "WebSocket/NATS"
    participant Backend

    User->>UI: Enter message
    UI->>Core: Create ChatAPIRequest
    Core->>Backend: POST /chat
    Backend->>WS: Stream chunks
    WS->>Core: ChunkData
    Core->>Core: Parse & Accumulate
    Core->>UI: Update segments
    Backend->>WS: MESSAGE_END
    WS->>Core: Final chunk
    Core->>UI: Final rendered message
