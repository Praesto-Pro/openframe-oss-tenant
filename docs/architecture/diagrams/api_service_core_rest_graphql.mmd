flowchart TD
    Client["Frontend / External Client"] --> Gateway["Gateway Service"]
    Gateway --> Api["Api Service Core Rest Graphql"]

    subgraph api_layer["API Layer"]
        RestControllers["REST Controllers"]
        GraphQL["GraphQL DataFetchers"]
        Security["Security Filter Chain"]
    end

    subgraph service_layer["Service Layer"]
        DomainServices["Domain Services"]
        Processors["Post-Processors"]
    end

    subgraph persistence_layer["Persistence Layer"]
        MongoRepos["Mongo Repositories"]
        DataLoaders["GraphQL DataLoaders"]
    end

    Gateway --> Security
    Security --> RestControllers
    Security --> GraphQL

    RestControllers --> DomainServices
    GraphQL --> DomainServices

    GraphQL --> DataLoaders
    DataLoaders --> MongoRepos

    DomainServices --> MongoRepos
