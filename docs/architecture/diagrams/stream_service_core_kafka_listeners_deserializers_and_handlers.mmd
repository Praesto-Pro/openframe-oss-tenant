flowchart TD
    KafkaInbound["Kafka Inbound Topics"] --> JsonListener["JsonKafkaListener"]
    JsonListener --> Processor["GenericJsonMessageProcessor"]

    Processor --> Deserializers["Tool-Specific Deserializers"]
    Deserializers --> Enrichment["IntegratedToolDataEnrichmentService"]
    Enrichment --> Handlers["DebeziumMessageHandlers"]

    Handlers --> CassandraHandler["DebeziumCassandraMessageHandler"]
    Handlers --> KafkaHandler["DebeziumKafkaMessageHandler"]

    CassandraHandler --> CassandraDB[("Cassandra")]
    KafkaHandler --> KafkaOutbound["Outbound Integrated Tool Events Topic"]

    subgraph Streams["Kafka Streams Processing"]
        ActivityStream["ActivityEnrichmentService"] --> EnrichedTopic["Enriched Fleet Events Topic"]
    end

    KafkaInbound --> ActivityStream
