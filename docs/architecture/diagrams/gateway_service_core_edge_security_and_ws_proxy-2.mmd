sequenceDiagram
    participant Client
    participant Gateway
    participant IssuerResolver as "Issuer Resolver"
    participant JwtManager as "JWT Manager"

    Client->>Gateway: HTTP Request with token
    Gateway->>Gateway: AddAuthorizationHeaderFilter
    Gateway->>IssuerResolver: Resolve issuer
    IssuerResolver->>Gateway: Allowed issuer list
    Gateway->>JwtManager: Decode & validate JWT
    JwtManager->>Gateway: Authenticated Principal
    Gateway->>Gateway: Role authorization
    Gateway->>Client: Forward or Reject
