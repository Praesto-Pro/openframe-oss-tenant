flowchart TD
    Request["External API Request"] --> CheckPath["Path starts with /external-api"]
    CheckPath --> HasKey{API Key Present}

    HasKey -->|No| Reject["401 Unauthorized"]
    HasKey -->|Yes| Validate["Validate API Key"]

    Validate --> Valid{Valid?}
    Valid -->|No| Reject
    Valid -->|Yes| RateCheck["Check Rate Limit"]

    RateCheck --> Allowed{Allowed?}
    Allowed -->|No| TooMany["429 Too Many Requests"]
    Allowed -->|Yes| Forward["Forward with User Headers"]
