flowchart TD
    LoginRequest["/oauth/login"] --> BuildRedirect["Build Authorize Redirect"]
    BuildRedirect --> StoreState["Create State JWT"]
    StoreState --> SetCookie["Set OAuth State Cookie"]
    SetCookie --> RedirectAuth["302 Redirect to Authorization Server"]

    CallbackRequest["/oauth/callback"] --> ValidateState["Validate State"]
    ValidateState --> ExchangeCode["Exchange Code for Tokens"]
    ExchangeCode --> SetAuthCookies["Set Access + Refresh Cookies"]
    SetAuthCookies --> ClearState["Clear State Cookie"]
    ClearState --> FinalRedirect["302 Redirect to Frontend"]
