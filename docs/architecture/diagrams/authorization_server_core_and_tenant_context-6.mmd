flowchart TD
    subgraph WebLayer["Web Layer"]
        Controllers["Controllers"]
        Filters["TenantContextFilter"]
    end

    subgraph SecurityLayer["Security Layer"]
        AuthServer["AuthorizationServerConfig"]
        SecurityCfg["SecurityConfig"]
        SuccessHandler["AuthSuccessHandler"]
    end

    subgraph ServiceLayer["Service Layer"]
        UserSvc["UserService"]
        TenantKeySvc["TenantKeyService"]
        SsoSvc["SSOConfigService"]
    end

    subgraph Persistence["Persistence Layer"]
        MongoAuth["MongoAuthorizationService"]
        MongoClient["MongoRegisteredClientRepository"]
    end

    Controllers --> SecurityLayer
    SecurityLayer --> ServiceLayer
    ServiceLayer --> Persistence
