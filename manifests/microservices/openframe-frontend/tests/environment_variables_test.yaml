suite: test environment variable configuration
templates:
  - templates/deployment.yaml
tests:
  - it: should have NEXT_PUBLIC_AUTH_CHECK_INTERVAL environment variable
    asserts:
      - contains:
          path: spec.template.spec.containers[0].env
          content:
            name: NEXT_PUBLIC_AUTH_CHECK_INTERVAL
            value: "30000"

  - it: should have exactly 1 inline environment variable
    asserts:
      - hasDocuments:
          count: 1
      - lengthEqual:
          path: spec.template.spec.containers[0].env
          count: 1

  - it: should use configMapRef for additional environment variables
    asserts:
      - equal:
          path: spec.template.spec.containers[0].envFrom[0].configMapRef.name
          value: microservices
