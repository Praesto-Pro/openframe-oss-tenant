<!-- source-hash: 11352bf2c285927d3e18203240be46f7 -->
Manages tool execution processes with support for both cross-platform and Windows-specific user session handling. This service provides robust process management including retry logic, kill functionality, and proper Windows session integration for GUI tools.

## Key Components

- **ToolRunManager** - Main service for executing tools with comprehensive process management
- **Windows Session Management** - Advanced Windows-specific functions for finding and launching processes in active user sessions
- **Process Lifecycle** - Handles tool startup, monitoring, and cleanup with retry mechanisms
- **Cross-platform Support** - Unix/Linux process management with Windows session integration

### Core Functions

- `get_active_user_session()` - Detects active Windows user sessions for GUI tool execution
- `launch_process_in_user_session()` - Launches processes in user desktop sessions with proper token handling
- `launch_process_in_console_session()` - Alternative Windows process launching method
- Process monitoring and cleanup utilities

## Usage Example

```rust
use crate::services::tool_run_manager::ToolRunManager;
use crate::models::installed_tool::InstalledTool;

// Create tool run manager with dependencies
let tool_manager = ToolRunManager::new(
    installed_tools_service,
    params_resolver,
    kill_service
);

// Execute a tool with proper session handling
let tool = InstalledTool {
    name: "my-gui-tool".to_string(),
    path: "/usr/bin/my-tool".to_string(),
    // ... other fields
};

// On Windows, automatically detects active user session
// On Unix, uses standard process execution
tool_manager.run_tool(&tool, &["--arg1", "value1"]).await?;
```

The manager handles Windows complexities like WTS (Windows Terminal Services) session enumeration, user token duplication, and proper desktop assignment for GUI applications running from services.