<!-- source-hash: 89ae42e0f6e109a334c06f030e707cc3 -->
A Next.js client component that provides an interactive remote shell interface for devices using MeshCentral tunneling. This component renders a full-screen terminal emulator with PowerShell or CMD support for Windows devices.

## Key Components

- **RemoteShellPage**: Main component handling terminal initialization and MeshCentral connection
- **MeshControlClient**: Manages authentication and session control with MeshCentral
- **MeshTunnel**: Establishes secure tunnel connection for terminal communication
- **Terminal (xterm)**: Browser-based terminal emulator with fit addon for responsive sizing
- **Device Integration**: Fetches device details and validates MeshCentral agent availability

## Usage Example

This page component is accessed via routing with device ID and optional shell type:

```typescript
// URL structure
// /devices/[deviceId]/shell?shellType=powershell
// /devices/[deviceId]/shell?shellType=cmd

// Key features:
// - Auto-detects PowerShell vs CMD based on URL params
// - Establishes secure tunnel through MeshCentral
// - Real-time bidirectional terminal communication
// - Responsive terminal sizing with window resize handling
// - Connection status indicators and error handling

// Terminal initialization
const term = new Terminal({
  fontFamily: 'monospace',
  theme: { background: '#000000' },
  cursorBlink: true
})

// MeshCentral tunnel setup
const tunnel = new MeshTunnel({
  authCookie,
  nodeId: meshcentralAgentId,
  protocol: 1,
  options: { cols: term.cols, rows: term.rows },
  onData: (data) => term.write(data),
  onStateChange: (state) => setState(state)
})
```

The component includes loading states, error handling for missing MeshCentral agents, and automatic PowerShell command injection for Windows systems. It maintains terminal session state and provides connection management controls.