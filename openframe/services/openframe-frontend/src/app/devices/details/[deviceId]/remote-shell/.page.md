<!-- source-hash: 3bd98b019bc63166cf1cb746b3c9e486 -->
A Next.js page component that provides a web-based remote shell interface for devices through MeshCentral tunneling. It dynamically initializes an xterm.js terminal and establishes secure connections to remote devices for command-line access.

## Key Components

- **RemoteShellPage**: Main page component handling terminal initialization and MeshCentral connection
- **MeshTunnel**: WebSocket tunnel for secure communication with remote devices
- **MeshControlClient**: Client for managing MeshCentral authentication and sessions
- **Terminal Integration**: xterm.js terminal with fit addon for responsive sizing
- **Shell Type Support**: Configurable CMD or PowerShell interface for Windows devices

## Usage Example

```typescript
// URL structure for accessing remote shell
// /devices/remote-shell/[deviceId]?shellType=powershell

// Component handles automatic connection flow:
const tunnel = new MeshTunnel({
  authCookie,
  nodeId: meshcentralAgentId,
  protocol: 1,
  options: { cols: term.cols, rows: term.rows },
  onData: (data) => {
    // Write received data to terminal
    if (typeof data === 'string') term.write(data)
    else term.write(new TextDecoder().decode(data))
  },
  onStateChange: (state) => setState(state)
})

// Terminal initialization with xterm.js
const term = new Terminal({
  fontFamily: 'monospace',
  theme: { background: '#000000' },
  cursorBlink: true
})
```

The component provides loading states, error handling for missing MeshCentral agents, and responsive terminal sizing with automatic PowerShell initialization for Windows devices.